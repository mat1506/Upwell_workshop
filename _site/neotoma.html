<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; } /* Alert */
code span.an { color: #008000; } /* Annotation */
code span.at { } /* Attribute */
code span.bu { } /* BuiltIn */
code span.cf { color: #0000ff; } /* ControlFlow */
code span.ch { color: #008080; } /* Char */
code span.cn { color: #585cf6; } /* Constant */
code span.co { color: #4c886b; } /* Comment */
code span.cv { color: #008000; } /* CommentVar */
code span.do { color: #008000; } /* Documentation */
code span.dv { color: #0000cd; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cd; } /* Float */
code span.im { } /* Import */
code span.in { color: #008000; } /* Information */
code span.kw { color: #0000ff; } /* Keyword */
code span.op { color: #687687; } /* Operator */
code span.ot { color: #ff4000; } /* Other */
code span.pp { color: #ff4000; } /* Preprocessor */
code span.sc { color: #008080; } /* SpecialChar */
code span.ss { color: #008080; } /* SpecialString */
code span.st { color: #036a07; } /* String */
code span.va { } /* Variable */
code span.vs { color: #008080; } /* VerbatimString */
code span.wa { color: #008000; font-weight: bold; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
  <title>Taller bases de datos: Análisis Demo de la base de datos NeotomaDB en Chile</title>

  <meta property="description" itemprop="description" content="Un repaso sobre la situación actual de las bases de datos del proyecto AbrocomaDB"/>

  <link rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"/>

  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2022-07-14"/>
  <meta property="article:created" itemprop="dateCreated" content="2022-07-14"/>
  <meta name="article:author" content="Matías Frugone-Álvarez"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Taller bases de datos: Análisis Demo de la base de datos NeotomaDB en Chile"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="Un repaso sobre la situación actual de las bases de datos del proyecto AbrocomaDB"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:site_name" content="Taller bases de datos"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Taller bases de datos: Análisis Demo de la base de datos NeotomaDB en Chile"/>
  <meta property="twitter:description" content="Un repaso sobre la situación actual de las bases de datos del proyecto AbrocomaDB"/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","output"]}},"value":[{"type":"character","attributes":{},"value":["Análisis Demo de la base de datos NeotomaDB en Chile"]},{"type":"character","attributes":{},"value":["Un repaso sobre la situación actual de las bases de datos del proyecto AbrocomaDB\n"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url","affiliation","affiliation_url"]}},"value":[{"type":"character","attributes":{},"value":["Matías Frugone-Álvarez"]},{"type":"character","attributes":{},"value":["https://matfrugone.netlify.app"]},{"type":"character","attributes":{},"value":["Postdoctorado UPWELL"]},{"type":"character","attributes":{},"value":["https://matfrugone.netlify.app"]}]}]},{"type":"character","attributes":{},"value":["2022-07-14"]},{"type":"character","attributes":{},"value":["distill::distill_article"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  <!--radix_placeholder_navigation_in_header-->
  <meta name="distill:offset" content=""/>

  <script type="application/javascript">

    window.headroom_prevent_pin = false;

    window.document.addEventListener("DOMContentLoaded", function (event) {

      // initialize headroom for banner
      var header = $('header').get(0);
      var headerHeight = header.offsetHeight;
      var headroom = new Headroom(header, {
        tolerance: 5,
        onPin : function() {
          if (window.headroom_prevent_pin) {
            window.headroom_prevent_pin = false;
            headroom.unpin();
          }
        }
      });
      headroom.init();
      if(window.location.hash)
        headroom.unpin();
      $(header).addClass('headroom--transition');

      // offset scroll location for banner on hash change
      // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
      window.addEventListener("hashchange", function(event) {
        window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
      });

      // responsive menu
      $('.distill-site-header').each(function(i, val) {
        var topnav = $(this);
        var toggle = topnav.find('.nav-toggle');
        toggle.on('click', function() {
          topnav.toggleClass('responsive');
        });
      });

      // nav dropdowns
      $('.nav-dropbtn').click(function(e) {
        $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
        $(this).parent().siblings('.nav-dropdown')
           .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $("body").click(function(e){
        $('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $(".nav-dropdown").click(function(e){
        e.stopPropagation();
      });
    });
  </script>

  <style type="text/css">

  /* Theme (user-documented overrideables for nav appearance) */

  .distill-site-nav {
    color: rgba(255, 255, 255, 0.8);
    background-color: #0F2E3D;
    font-size: 15px;
    font-weight: 300;
  }

  .distill-site-nav a {
    color: inherit;
    text-decoration: none;
  }

  .distill-site-nav a:hover {
    color: white;
  }

  @media print {
    .distill-site-nav {
      display: none;
    }
  }

  .distill-site-header {

  }

  .distill-site-footer {

  }


  /* Site Header */

  .distill-site-header {
    width: 100%;
    box-sizing: border-box;
    z-index: 3;
  }

  .distill-site-header .nav-left {
    display: inline-block;
    margin-left: 8px;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header .nav-left {
      margin-left: 0;
    }
  }


  .distill-site-header .nav-right {
    float: right;
    margin-right: 8px;
  }

  .distill-site-header a,
  .distill-site-header .title {
    display: inline-block;
    text-align: center;
    padding: 14px 10px 14px 10px;
  }

  .distill-site-header .title {
    font-size: 18px;
    min-width: 150px;
  }

  .distill-site-header .logo {
    padding: 0;
  }

  .distill-site-header .logo img {
    display: none;
    max-height: 20px;
    width: auto;
    margin-bottom: -4px;
  }

  .distill-site-header .nav-image img {
    max-height: 18px;
    width: auto;
    display: inline-block;
    margin-bottom: -3px;
  }



  @media screen and (min-width: 1000px) {
    .distill-site-header .logo img {
      display: inline-block;
    }
    .distill-site-header .nav-left {
      margin-left: 20px;
    }
    .distill-site-header .nav-right {
      margin-right: 20px;
    }
    .distill-site-header .title {
      padding-left: 12px;
    }
  }


  .distill-site-header .nav-toggle {
    display: none;
  }

  .nav-dropdown {
    display: inline-block;
    position: relative;
  }

  .nav-dropdown .nav-dropbtn {
    border: none;
    outline: none;
    color: rgba(255, 255, 255, 0.8);
    padding: 16px 10px;
    background-color: transparent;
    font-family: inherit;
    font-size: inherit;
    font-weight: inherit;
    margin: 0;
    margin-top: 1px;
    z-index: 2;
  }

  .nav-dropdown-content {
    display: none;
    position: absolute;
    background-color: white;
    min-width: 200px;
    border: 1px solid rgba(0,0,0,0.15);
    border-radius: 4px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
    z-index: 1;
    margin-top: 2px;
    white-space: nowrap;
    padding-top: 4px;
    padding-bottom: 4px;
  }

  .nav-dropdown-content hr {
    margin-top: 4px;
    margin-bottom: 4px;
    border: none;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .nav-dropdown-active {
    display: block;
  }

  .nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
    color: black;
    padding: 6px 24px;
    text-decoration: none;
    display: block;
    text-align: left;
  }

  .nav-dropdown-content .nav-dropdown-header {
    display: block;
    padding: 5px 24px;
    padding-bottom: 0;
    text-transform: uppercase;
    font-size: 14px;
    color: #999999;
    white-space: nowrap;
  }

  .nav-dropdown:hover .nav-dropbtn {
    color: white;
  }

  .nav-dropdown-content a:hover {
    background-color: #ddd;
    color: black;
  }

  .nav-right .nav-dropdown-content {
    margin-left: -45%;
    right: 0;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
    .distill-site-header a.nav-toggle {
      float: right;
      display: block;
    }
    .distill-site-header .title {
      margin-left: 0;
    }
    .distill-site-header .nav-right {
      margin-right: 0;
    }
    .distill-site-header {
      overflow: hidden;
    }
    .nav-right .nav-dropdown-content {
      margin-left: 0;
    }
  }


  @media screen and (max-width: 768px) {
    .distill-site-header.responsive {position: relative; min-height: 500px; }
    .distill-site-header.responsive a.nav-toggle {
      position: absolute;
      right: 0;
      top: 0;
    }
    .distill-site-header.responsive a,
    .distill-site-header.responsive .nav-dropdown {
      display: block;
      text-align: left;
    }
    .distill-site-header.responsive .nav-left,
    .distill-site-header.responsive .nav-right {
      width: 100%;
    }
    .distill-site-header.responsive .nav-dropdown {float: none;}
    .distill-site-header.responsive .nav-dropdown-content {position: relative;}
    .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
      display: block;
      width: 100%;
      text-align: left;
    }
  }

  /* Site Footer */

  .distill-site-footer {
    width: 100%;
    overflow: hidden;
    box-sizing: border-box;
    z-index: 3;
    margin-top: 30px;
    padding-top: 30px;
    padding-bottom: 30px;
    text-align: center;
  }

  /* Headroom */

  d-title {
    padding-top: 6rem;
  }

  @media print {
    d-title {
      padding-top: 4rem;
    }
  }

  .headroom {
    z-index: 1000;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
  }

  .headroom--transition {
    transition: all .4s ease-in-out;
  }

  .headroom--unpinned {
    top: -100px;
  }

  .headroom--pinned {
    top: 0;
  }

  /* adjust viewport for navbar height */
  /* helps vertically center bootstrap (non-distill) content */
  .min-vh-100 {
    min-height: calc(100vh - 100px) !important;
  }

  </style>

  <script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
  <link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
  <script src="site_libs/headroom-0.9.4/headroom.min.js"></script>
  <script src="site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
  <script src="site_libs/fuse-6.4.1/fuse.min.js"></script>

  <script type="application/javascript">

  function getMeta(metaName) {
    var metas = document.getElementsByTagName('meta');
    for (let i = 0; i < metas.length; i++) {
      if (metas[i].getAttribute('name') === metaName) {
        return metas[i].getAttribute('content');
      }
    }
    return '';
  }

  function offsetURL(url) {
    var offset = getMeta('distill:offset');
    return offset ? offset + '/' + url : url;
  }

  function createFuseIndex() {

    // create fuse index
    var options = {
      keys: [
        { name: 'title', weight: 20 },
        { name: 'categories', weight: 15 },
        { name: 'description', weight: 10 },
        { name: 'contents', weight: 5 },
      ],
      ignoreLocation: true,
      threshold: 0
    };
    var fuse = new window.Fuse([], options);

    // fetch the main search.json
    return fetch(offsetURL('search.json'))
      .then(function(response) {
        if (response.status == 200) {
          return response.json().then(function(json) {
            // index main articles
            json.articles.forEach(function(article) {
              fuse.add(article);
            });
            // download collections and index their articles
            return Promise.all(json.collections.map(function(collection) {
              return fetch(offsetURL(collection)).then(function(response) {
                if (response.status === 200) {
                  return response.json().then(function(articles) {
                    articles.forEach(function(article) {
                      fuse.add(article);
                    });
                  })
                } else {
                  return Promise.reject(
                    new Error('Unexpected status from search index request: ' +
                              response.status)
                  );
                }
              });
            })).then(function() {
              return fuse;
            });
          });

        } else {
          return Promise.reject(
            new Error('Unexpected status from search index request: ' +
                        response.status)
          );
        }
      });
  }

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // get search element (bail if we don't have one)
    var searchEl = window.document.getElementById('distill-search');
    if (!searchEl)
      return;

    createFuseIndex()
      .then(function(fuse) {

        // make search box visible
        searchEl.classList.remove('hidden');

        // initialize autocomplete
        var options = {
          autoselect: true,
          hint: false,
          minLength: 2,
        };
        window.autocomplete(searchEl, options, [{
          source: function(query, callback) {
            const searchOptions = {
              isCaseSensitive: false,
              shouldSort: true,
              minMatchCharLength: 2,
              limit: 10,
            };
            var results = fuse.search(query, searchOptions);
            callback(results
              .map(function(result) { return result.item; })
            );
          },
          templates: {
            suggestion: function(suggestion) {
              var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
                ? `<img src="${offsetURL(suggestion.preview)}"</img>`
                : '';
              var html = `
                <div class="search-item">
                  <h3>${suggestion.title}</h3>
                  <div class="search-item-description">
                    ${suggestion.description || ''}
                  </div>
                  <div class="search-item-preview">
                    ${img}
                  </div>
                </div>
              `;
              return html;
            }
          }
        }]).on('autocomplete:selected', function(event, suggestion) {
          window.location.href = offsetURL(suggestion.path);
        });
        // remove inline display style on autocompleter (we want to
        // manage responsive display via css)
        $('.algolia-autocomplete').css("display", "");
      })
      .catch(function(error) {
        console.log(error);
      });

  });

  </script>

  <style type="text/css">

  .nav-search {
    font-size: x-small;
  }

  /* Algolioa Autocomplete */

  .algolia-autocomplete {
    display: inline-block;
    margin-left: 10px;
    vertical-align: sub;
    background-color: white;
    color: black;
    padding: 6px;
    padding-top: 8px;
    padding-bottom: 0;
    border-radius: 6px;
    border: 1px #0F2E3D solid;
    width: 180px;
  }


  @media screen and (max-width: 768px) {
    .distill-site-nav .algolia-autocomplete {
      display: none;
      visibility: hidden;
    }
    .distill-site-nav.responsive .algolia-autocomplete {
      display: inline-block;
      visibility: visible;
    }
    .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
      margin-left: 0;
      width: 400px;
      max-height: 400px;
    }
  }

  .algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
    width: 90%;
    outline: none;
    border: none;
  }

  .algolia-autocomplete .aa-hint {
    color: #999;
  }
  .algolia-autocomplete .aa-dropdown-menu {
    width: 550px;
    max-height: 70vh;
    overflow-x: visible;
    overflow-y: scroll;
    padding: 5px;
    margin-top: 3px;
    margin-left: -150px;
    background-color: #fff;
    border-radius: 5px;
    border: 1px solid #999;
    border-top: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
    cursor: pointer;
    padding: 5px 4px;
    border-bottom: 1px solid #eee;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
    border-bottom: none;
    margin-bottom: 2px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
    overflow: hidden;
    font-size: 0.8em;
    line-height: 1.4em;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
    font-size: 1rem;
    margin-block-start: 0;
    margin-block-end: 5px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
    display: inline-block;
    overflow: hidden;
    height: 2.8em;
    width: 80%;
    margin-right: 4%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
    display: inline-block;
    width: 15%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
    height: 3em;
    width: auto;
    display: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
    display: initial;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
    background-color: #eee;
  }
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
    font-weight: bold;
    font-style: normal;
  }

  </style>


  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        if ($(this).children()[0].nodeName == "D-FOOTNOTE") {
          var fn = $(this).children()[0]
          $(this).html(fn.shadowRoot.querySelector("sup"))
          $(this).id = fn.id
          fn.remove()
        }
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          return "<p>" + $('#ref-' + ref).html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // fix footnotes in tables (#411)
      // replacing broken distill.pub feature
      $('table d-footnote').each(function() {
        // we replace internal showAtNode methode which is triggered when hovering a footnote
        this.hoverBox.showAtNode = function(node) {
          // ported from https://github.com/distillpub/template/pull/105/files
          calcOffset = function(elem) {
              let x = elem.offsetLeft;
              let y = elem.offsetTop;
              // Traverse upwards until an `absolute` element is found or `elem`
              // becomes null.
              while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                  x += elem.offsetLeft;
                  y += elem.offsetTop;
              }

              return { left: x, top: y };
          }
          // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
          const bbox = node.getBoundingClientRect();
          const offset = calcOffset(node);
          this.show([offset.left + bbox.width, offset.top + bbox.height]);
        }
      })

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      // ignore leaflet img layers (#106)
      figures = figures.filter(':not(img[class*="leaflet"])')
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="site_libs/header-attrs-2.14/header-attrs.js"></script>
  <script src="site_libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
  <script src="site_libs/jquery-1.12.4/jquery.min.js"></script>
  <link href="site_libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
  <script src="site_libs/leaflet-1.3.1/leaflet.js"></script>
  <link href="site_libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
  <script src="site_libs/proj4-2.6.2/proj4.min.js"></script>
  <script src="site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
  <link href="site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
  <script src="site_libs/leaflet-binding-2.1.0/leaflet.js"></script>
  <script src="site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <script type="text/javascript" src="https://www.cookieconsent.com/releases/3.1.0/cookie-consent.js"></script>
  <script type="text/javascript">
  document.addEventListener('DOMContentLoaded', function () {
  cookieconsent.run({
  'notice_banner_type':'simple',
  'consent_type': 'express',
  'palette': 'light',
  'language': 'en',
  'website_name': 'Upwell_taller_interno',
  'cookies_policy_url': 'url',
  'change_preferences_selector':'#CookiePreferences'
  });});</script>
  <script type="text/plain" cookie-consent="tracking" async src="https://www.googletagmanager.com/gtag/js?id=G-EFFL8DYH1G"></script>
  <script type="text/plain" cookie-consent="tracking">
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-EFFL8DYH1G');
  </script>
  <style type="text/css">
  @import url('https://fonts.googleapis.com/css?family=Noto+Serif+JP:300, 300i&display=Amiri');

  @import url('https://fonts.googleapis.com/css?family=Lato:400,400i,700&display=swap');

  @import url('https://fonts.googleapis.com/css?family=IBM+Plex+Mono&display=swap');

  body {
    font-family: "Lato";
    /*color: #1f1f1f;*/
    color: #404040;
    font-size: 16px;
  }


  h1, h2, h3, h4, h5, h6 {
    font-family: "Noto Serif JP";
    letter-spacing: 2px;
    line-height: 2rem; /* increases, so wrapping headers don't overlap */
    color: #333399;
    font-weight: 400;
  }

  d-title {
    padding-top: 13rem; /*so that navbar doesn't overlap fixed title */
  }

  d-title h1,
  d-article h2 {
  	font-weight: 300;
  }


  /* --------------Navbar-------------------- */


  /* background-image for fade-to-white color of navbar */
  .distill-site-header{
    padding: 40px 0px;
    background-image: linear-gradient(to bottom, rgba(185, 206, 172, 1), rgba(255,255,255,0.5));
    background-color: transparent;
    font-size: 15px;
    font-family: "Noto Serif JP";
    letter-spacing: 2px;
    text-transform: uppercase;
  }

  .distill-site-header .logo img{
    max-height: 40px; /* Makes logo bigger, default was 20px */
  }

  /* dropdown navbar color on mobile */

  @media screen and (max-width: 768px){
    .distill-site-header.responsive {
        background: rgba(255,255,255,0.99);
    }
  }


  /* Navbar Links with Animated Hover */


  .distill-site-header a { /* A normal link in navbar */
    color: #1f1f1f;
    display: inline-block; /* This line and line below is so pseudo-element will work later */
    position: relative;
    text-decoration: none;
    padding-left: 0px; /* overrides default so animation looks Ok */
    padding-right: 0px; /* overrides default so animation looks Ok */
    margin: 10px 14px; /* replaces default padding values for margin values */
  }


  .distill-site-header a:hover { /* (unanimated) hover behavior for navbar links */
    color: #787878;
    padding-left: 0px; /* overrides default so animation looks Ok */
    padding-right: 0px; /* overrides default so animation looks Ok */
    margin: 10px 14px; /* replaces default padding values for margin values */
  }

  .distill-site-header a:before { /*Creates pseudoelement line under link */
    background-color: #787878;
    content: '';
    height: 1px;
    position: absolute;
    bottom: -1px;
    transition: width 0.3s ease-in-out; /* animate the width */
    width: 100%;
  }

  .distill-site-header a:hover:before {
    width: 0; /* Shrinks width of pseudoelement to 0 when hovered */
  }

  /* Makes sure animation does NOT apply to Title or Logo links (or toggle on mobile) */

  .distill-site-header a.title:before, .distill-site-nav a.logo:before, a.nav-toggle:before {
    display: none;
  }

  .distill-site-header a.title, .distill-site-nav a.logo {
    padding: 10px 0px;
    margin: 10px 14px;
  }


  /* No navbar links on mobile except title and nav-toggle */

  @media screen and (max-width: 768px) {
    .distill-site-header a, .distill-site-header .nav-dropdown {
      display: none;
    }

    .distill-site-header a.title, .distill-site-header a.nav-toggle {
      display: inline-block;
      padding: 10px 0px;
      margin: 10px 14px;
    }
  }

  /* -------------Appendix---------------- */

  d-appendix {
    background-color: #fdf7f9;
    border-top: none !important;
    color: #1a162d !important;
  }

  /* -------------Footer------------------*/

  .distill-site-footer {
    color: #7e7b88;
    background-color: #ca225e3d;
    margin-top: 0px;
    padding: 50px 20px;
    font-size: 13px;
    letter-spacing: 1px;
    text-transform: uppercase;
    line-height: 12px;

  }

  d-byline div.byline.grid div p,
  d-byline,
  d-byline p,
  p.author,
  p.affiliation,
  d-byline h3,
  .d-toc,
  .d-toc-header,
  .d-toc ul,
  d-appendix p {
  	font-size: 0.9rem;
  }

  d-appendix h3 + * {
  	margin-top: 1.5em !important;
  }


  /*----- COLORED LIST BULLET----*/

  d-article ul {
    list-style: none; /* Remove default bullets */
  }

  d-article ul li::before {
    content: "\2022";  /* Add content: \2022 is the CSS Code/unicode for a bullet */
    color: #CA225E; /* Change the color */
    font-weight: normal; /* If you want it to be bold */
    display: inline-block; /* Needed to add space between the bullet and the text */
    width: 1.5em; /* Also needed for space (tweak if needed) */
    margin-left: -1.5em; /* Also needed for space (tweak if needed) */
  }

  d-article ul > li > p {
    display: inline; /* to have content show up next to bullet */
    line-height: 1.6em;
  }

  d-article ul > li { /*to add back in space between bullet items that I took away by making p display inline */
    margin-top: 1em;
    margin-bottom: 1em;
  }

  .d-toc ul li::before {
    content: " ";  /* Remove toc bullets */
  }

  </style>
  <!--/radix_placeholder_site_in_header-->

  <link rel="stylesheet" href="styles.css" type="text/css"/>

</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Análisis Demo de la base de datos NeotomaDB en Chile","description":"Un repaso sobre la situación actual de las bases de datos del proyecto AbrocomaDB","authors":[{"author":"Matías Frugone-Álvarez","authorURL":"https://matfrugone.netlify.app","affiliation":"Postdoctorado UPWELL","affiliationURL":"https://matfrugone.netlify.app","orcidID":""}],"publishedDate":"2022-07-14T00:00:00.000-04:00","citationText":"Frugone-Álvarez, 2022"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a class="logo" href="https://www.upwell.cl/web/">
<img src="images/logo2.png" alt="Logo"/>
</a>
<a href="index.html" class="title">Taller bases de datos</a>
</div>
<div class="nav-right">
<a href="index.html">Home</a>
<a href="about.html">About</a>
<a href="install.html">Install Party</a>
<a href="rgithub.html">Git/GitHub con R</a>
<a href="EjemploR.html">Ejemplo con R</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Análisis Demo de la base de datos NeotomaDB en Chile</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>Un repaso sobre la situación actual de las bases de datos del
proyecto AbrocomaDB</p></p>
</div>

<div class="d-byline">
  Matías Frugone-Álvarez <a href="https://matfrugone.netlify.app"
class="uri">https://matfrugone.netlify.app</a> (Postdoctorado UPWELL)<a
href="https://matfrugone.netlify.app"
class="uri">https://matfrugone.netlify.app</a>
  
<br/>2022-07-14
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#finding-data">Finding Data</a>
<ul>
<li><a href="#explorer">Explorer</a>
<ul>
<li><a href="#getting-started">Getting Started</a></li>
<li><a href="#search-for-data">Search for Data</a></li>
<li><a href="#tips-and-tricks-before-we-start">Tips and tricks before we
start</a></li>
<li><a href="#download-data">Download Data</a></li>
</ul></li>
</ul></li>
<li><a href="#web-api--application-programming-interface">Web API-
Application Programming Interface</a>
<ul>
<li><a href="#what-is-a-web-api">What is a Web API?</a></li>
<li><a href="#more-about-json">More about JSON</a></li>
<li><a href="#more-on-the-neotoma-db-api">More on the Neotoma DB
API</a></li>
</ul></li>
<li><a href="#the-neotoma-package">The <code>neotoma</code> Package</a>
<ul>
<li><a href="#finding-sites-1">Finding sites</a></li>
<li><a href="#getting-datasets">Getting Datasets</a></li>
<li><a href="#get_download">Get_Download</a></li>
</ul></li>
<li><a href="#multi-site-analysis">Multi-Site Analysis</a></li>
</ul>
</nav>
</div>
<h1 id="introduction">Introduction</h1>
<p>This workshop is intended to introduce individuals to different ways
of analysing data stored in the Neotoma Paleoecology Database and the
<code>neotoma</code> package for R.</p>
<ol type="1">
<li>Introduction to Neotoma Explorer for easy data exploration and
extraction.</li>
<li>Training in the use of the Neotoma R package to archive, access, and
analyze paleoecological data.</li>
</ol>
<p>Neotoma is a multiproxy paleo-database that stores a range of
paleoecological &amp; paleoenvironmental data. One of the strengths of
Neotoma is the ability to compare different paleo-proxy data such as
fossil pollen, diatoms, ostracodes, insects, charcoal, and geochemical
data. In addition, the database is structured to allow the creation and
storage of age models built on absolute dates derived from age control
points and stratigraphic sections. Neotoma is a public-access,
community-supported database that has emerged as the standard repository
for Pliocene and Quaternary paleoecological data.</p>
<p>More teaching materials can be found <a
href="http://www.neotomadb.org/education/category/higher_ed/">in
Neotoma’s educational resources</a>.</p>
<p>This workshop is available on GitHub, in the NeotomaDB <a
href="https://github.com/NeotomaDB/Workshops/tree/master/IBSQuito19">repository</a>.</p>
<h1 id="finding-data">Finding Data</h1>
<h2 id="explorer">Explorer</h2>
<h3 id="getting-started">Getting Started</h3>
<ol type="1">
<li>Go to <a href="http://www.neotomadb.org/"
class="uri">http://www.neotomadb.org/</a> and click on the ‘Explorer’
picture, or navigate directly to the <a
href="http://apps.neotomadb.org/Explorer/">Explorer App</a></li>
<li>Pan (by dragging), or change the zoom so that your window is
centered on Chile.</li>
</ol>
<h3 id="search-for-data">Search for Data</h3>
<h3 id="tips-and-tricks-before-we-start">Tips and tricks before we
start</h3>
<ol type="1">
<li><p>Show/Hide Search Results</p>
<ol type="a">
<li>We will accumulate many search layers - it may be getting a bit
confusing. Find the icon that lets you show/hide/combine search layers
and use it to hide or delete some of your searches.</li>
</ol></li>
<li><p>Rename searches</p>
<ol type="a">
<li>Searches from the “Basic” search window are automatically named, but
not “Advanced” searches.Add names for your searches as you go at the
bottom of the Search dialog.</li>
</ol></li>
</ol>
<h4 id="finding-sites">Finding sites</h4>
<ol type="1">
<li><p><strong>Find a known site</strong></p>
<ol type="a">
<li>Using the Search dialog window (Metadata subtab;Collection
type:Core;Database:Neotoma; Site Name), find “Laguna del Maule”.</li>
<li>Once you’ve performed the search, click on the point that appears. A
window will pop up with some information about this record.</li>
</ol></li>
<li><p><strong>Explore sites by geography</strong></p>
<ol type="a">
<li><p>Using the Search dialog window, first choose “dataset type =
Pollen” at the top</p></li>
<li><p>Then, in the Space subtab, click “Search by extent”</p>
<ol type="1">
<li>Click the “Extent” dropdown menu and search by shape, select the
rectangle by using SHIFT+pointer, then draw a rectangle on the map in
your chosen region of Chile (for example, South of Chile).</li>
</ol></li>
</ol></li>
<li><p><strong>Find all sites within a database</strong> Chile and the
region has a rich history in paleoecological reseach of fossil pollen
data. Let’s see how many are currently in Neotoma:</p>
<ol type="a">
<li>Search Window, Metadata subtab;Collection type: Core; Database
field</li>
<li>Find all sites within the Latin American Pollen Database.</li>
</ol>
<ul>
<li>Not that many sites from the region are in Neotoma currently - only
36 datasets across 36 sites</li>
</ul></li>
</ol>
<h4 id="find-a-taxon">Find a Taxon</h4>
<ol type="1">
<li><p><strong>Search for a single taxon.</strong></p>
<ol type="a">
<li>Search Window, select Dataset type: pollen, and use Taxon name</li>
<li>Find all sites within the Latin American Pollen Database with
<strong>Chenopodioideae</strong> records</li>
</ol></li>
<li><p><strong>Search for multiple taxa</strong></p>
<ol type="a">
<li>Let’s re-search for <strong>Chenopodioideae</strong>, but make sure
we’ve included all relevant records.</li>
</ol></li>
</ol>
<h4 id="find-all-charcoal-and-pollen-records-in-the-database">Find all
charcoal and pollen records in the database</h4>
<ol type="1">
<li><strong>Search window, Dataset type = “Charcoal”</strong></li>
<li><strong>Search window, Dataset type = “Pollen”</strong></li>
</ol>
<h4 id="multi-taxon-search">Multi-Taxon Search</h4>
<ol type="1">
<li><p><strong>Find all sites with Chenopodioideae pollen between 10,000
and 500 years ago.</strong></p>
<ol type="a">
<li>For <strong>Chenopodioideae</strong>, first click on “Dataset Type”
= “pollen”</li>
<li>Then use the Taxon Selection which you can use by clicking on the
gears icon to the right of the ‘Taxon’ field in the ‘Search’
window.</li>
</ol>
<ul>
<li>Enter ‘Taxa group’ = Vascular Plant, search for <em>Casuarina</em>,
click the box next to Taxon to check all taxa, then uncheck taxa like
“<em>Myrica/Casuarina</em>” or “<em>Casuarina/Corylus</em>”.</li>
</ul>
<ol type="a">
<li>Then click the ‘Abundance/density’ box and select &gt;5%.<br />
</li>
<li>Fill in the desired age range, and choose records that ‘intersects
result age range’.</li>
<li>Finally, click ‘Search’</li>
</ol></li>
<li><p><strong>Find all sites with <em>Nothofagus</em> between 10,000
and 500 years</strong></p>
<ol type="a">
<li>Use the ‘Advanced Taxon Selection’ which you can use by clicking on
the gears icon to the right of the ‘Taxon’ field in the ‘Search’ window.
b Enter ‘Taxa group’ = Vascular Plant, search for <em>Nothofagus</em>,
click the box next to Taxon to check all taxa you want to include.</li>
<li>Set a relative abundance filter if you’d like (click the
‘Abundance/density’ box and select &gt;5%)<br />
</li>
<li>Fill in the desired age range, and choose records that ‘intersects
result age range’.</li>
<li>Finally, click ‘Search’</li>
</ol></li>
</ol>
<p>You can combine these two searches to find sites with either
Casuarina OR Nothfagus, or restrict it to only those sites with both
taxa.</p>
<h3 id="download-data">Download Data</h3>
<ol type="1">
<li>Find the icon in the menu that indicates ’View search results in
tables’and click on it.</li>
<li>Click on the Save icon to the right. The dataset will be saved as a
text file in CSV (comma separated value) format.</li>
<li>Open the downloaded CSV file in Excel or a text editor
(e.g. Notepad, Wordpad) to look at it.</li>
</ol>
<h1 id="web-api--application-programming-interface">Web API- Application
Programming Interface</h1>
<h2 id="what-is-a-web-api">What is a Web API?</h2>
<ol type="1">
<li>Set of protocols for building tools and applications that use a
specific web service</li>
<li>Often a structure for URL/URI formulation to make a query on a web
database, such as Neotoma, iDigBio, or the Paleobiology Database. + URL
= Uniform Resource Locator, or web address. + URI = Uniform Resource
Identifier, or web address of a service, like an API.</li>
<li>Calls are usually sent as URL <code>GET</code> statements: values
appended to a URL after a <code>?</code> that are processed as
parameters to be passed to the code running on the server. For example,
we can think of <a href="http://google.com/?q=bananas"
class="uri">http://google.com/?q=bananas</a> as if it were an R function
called <code>search()</code>, passed as
<code>search(q="bananas")</code>.</li>
</ol>
<p>Google has APIs for most of its products. You could write an R (or
Python, etc.) script that would connect to the Google Calendar API to
allow you to automatically change events on your calendar or report
agenda items back to you in your own custom environment. <a
href="https://hilaryparker.com/">Hilary Parker</a> has a nice example
for <a
href="https://hilaryparker.com/2014/05/27/sunsets-in-google-calendar-using-r/">adding
sunsets to Google Calendar</a> using R.</p>
<p>APIs exist for many important biological and paleobiological
databases. We will work through a quick example from Neotoma. Different
databases/services produce different kinds of API returns. The simplest
kinds are comma delimited text files, but many APIs are now returning
JSON documents.</p>
<h2 id="more-about-json">More about JSON</h2>
<p>At its most basic level, JSON transmits data objects in
attribute-value pairs. It has come to replace XML, which was the
previous standard for this sort of data transmission.</p>
<p>JSON is composed of objects, enclosed by curly brackets, which may
have any number of attributes named in quotes, with values after a
colon, separated by commas. You may also present an array, or an ordered
collection of values, enclosed in square brackets.</p>
<p>Let’s search the Neotoma DB via the API for <em>Casuarina</em>. Here
is the example API call:</p>
<p><a
href="">http://api.neotomadb.org/v1/data/sampledata?taxonname=Casuarina*</a></p>
<p>Notice when you make this call that the JSON is computer-friendly but
not human-friendly (though this depends on browser). Try it again with
the ‘pretty’ format tag:</p>
<p><a
href="">http://api.neotomadb.org/v1/data/sampledata?taxonname=Casuarina*&amp;format=pretty</a></p>
<p>You should be able to see the nested set of JSON objects, including
the occurrences returned as comma-separated objects within
<code>"data"</code>.</p>
<p>Try experimenting with the search, substituting different names.</p>
<p>JSON is becoming the standard for data transfer in web services. R
has several packages for dealing with JSON-formatted data. We will use
some examples from the package <a
href="https://cran.rstudio.com/web/packages/RJSONIO/index.html"><code>RJSONIO</code></a>.
We will also use the package <a
href="https://cran.rstudio.com/web/packages/Rcurl/index.html"><code>RCurl</code></a>,
which has functions to let you query APIs from within the R environment.
The <code>neotoma</code> package is built around the newer <a
href="https://cran.rstudio.com/web/packages/httr/index.html"><code>httr</code></a>
package.</p>
<h2 id="more-on-the-neotoma-db-api">More on the Neotoma DB API</h2>
<p>Based on the <em>Casuarina</em> example, you can see that the example
API call is reporting data from only part of the distributed database
schema of Neotoma. In fact, the Neotoma API is designed around a set of
different URLs, each of which allows a user to search a portion of the
database. So, if you want the full Site information for locations with
<em>Casuarina</em> present, you would have to search on
<em>Casuarina</em> in the SampleData URI (as we did in the example),
pull the DatasetID values from those returns, then search on the Dataset
URI (<a href="">http://api.neotomadb.org/v1/data/datasets</a>) for those
DatasetIDs, which would, in turn, produce the SiteIDs, which you would
then search on the Sites URI (<a
href="">http://api.neotomadb.org/v1/data/sites</a>). This sort of
searching would be cumbersome if you were to do it by hand, but
fortunately you can script a computer to do it for you. In fact, you
don’t have to write the scripts to do it, because they have already been
constructed and provided to the community as the R <a
href="https://cran.rstudio.com/web/packages/neotoma/index.html"><code>neotoma</code></a>
package.</p>
<p>The <code>neotoma</code> package will the the subject of our next
module, but bear in mind that the other APIs also have wrapper packages
to simplify data calls in R. The PaleoBioDB has a package,
<code>paleobioDB</code>, and iDigBio has a package,
<code>ridigbio</code>. The Earth-Life Consortium was aimed at creating a
single API and wrapping R package to access both PaleoBioDB and Neotoma
at the same time, as well as linking to many online museum databases and
iDigBio. We wanted to introduce you to the underlying architecture here
so you would understand what these packages are doing, and would know
that you can crack them open and hack your own solutions if you cannot
get them to give you the data or format of data that you need for your
work.</p>
<h1 id="the-neotoma-package">The <code>neotoma</code> Package</h1>
<p>Install the <code>neotoma</code> package, then add it to your
programming environment</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># install.packages('devtools')</span>
<span class='co'># devtools::install_github('ropensci/neotoma')</span>
<span class='co'># Add the packages to your programming environment </span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://docs.ropensci.org/neotoma'>neotoma</a></span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p><code>neotoma</code> has three core commands: <code>get_site</code>,
<code>get_dataset</code>, and <code>get_download</code>. The first two
return metadata for sites and datasets; the latter returns data. See
Goring <em>et al</em>. 2015 for a full description of the package and
example code. This exercise is partially based on those examples.</p>
<h3 id="finding-sites-1">Finding sites</h3>
<p>We’ll start with <code>get_site</code>. <code>get_site</code> returns
a <code>data.frame</code> with metadata about sites. You can use this to
find the spatial coverage of data in a region (e.g. using
<code>get_site</code> with a bounding box), or to get explicit site
information easily from more complex data objects. Use the command
<code>?get_site</code> to see all the options available.</p>
<p>You can easily search by site name, for example, finding “Laguna del
Maule”, a site in central Chile.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>maule_site</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://docs.ropensci.org/neotoma/reference/get_site.html'>get_site</a></span><span class='op'>(</span>sitename <span class='op'>=</span> <span class='st'>'Laguna del Maule%'</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>The API call was successful, you have returned  1 records.</code></pre>
</div>
<p>Examine the results</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>maule_site</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>        site.name      long       lat elev
 Laguna del Maule -70.50141 -36.05363 2160
A site object containing 1 sites and 8 parameters.</code></pre>
</div>
<p>While <code>maule_site</code> is a <code>data.frame</code> it also
has class <code>site</code>, that’s why the print output looks a little
different than a standard <code>data.frame</code>. That also allows you
to use some of the other <code>neotoma</code> functions more easily.</p>
<p>By default the search string is explicit, but because older sites,
especially pollen sites entered as part of COHMAP, often had appended
textual information (for example <code>(CA:British Columbia)</code>),
it’s often good practice to first search using a wildcard character. For
example, searching for “Marion” returns three sites:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#results= "hide"</span>
<span class='va'>marion_site</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://docs.ropensci.org/neotoma/reference/get_site.html'>get_site</a></span><span class='op'>(</span>sitename <span class='op'>=</span> <span class='st'>'Marion%'</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>The API call was successful, you have returned  3 records.</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>marion_site</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>You can also search by lat/lon bounding box. This one roughly
corresponds to central Chile (A numeric vector c(lonW, latS, lonE, latN)
representing the bounding box within which to search for sites. The
convention here is to use negative values for longitudes west of
Greenwich or longitudes south of the equator)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#results= "hide"</span>
<span class='va'>ch_sites</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://docs.ropensci.org/neotoma/reference/get_site.html'>get_site</a></span><span class='op'>(</span>loc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>72</span>, <span class='op'>-</span><span class='fl'>35</span>, <span class='op'>-</span><span class='fl'>68</span>, <span class='op'>-</span><span class='fl'>31</span><span class='op'>)</span><span class='op'>)</span> 
</code></pre>
</div>
<pre><code>The API call was successful, you have returned  1 records.</code></pre>
</div>
<p>You can also search by geopolitical name or geopolitical IDs
(<code>gpid</code>) stored in Neotoma. For a list of names and gpids, go
to <a href="http://api.neotomadb.org/apdx/geopol.htm"
class="uri">http://api.neotomadb.org/apdx/geopol.htm</a>, or use the
<code>get_table(table.name = "GeoPoliticalUnits")</code> command. This
command works either with an explicit numeric ID, or with a text
string:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># get all sites in Chile (gpid=7956)</span>
<span class='va'>CH_sites</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://docs.ropensci.org/neotoma/reference/get_site.html'>get_site</a></span><span class='op'>(</span>gpid <span class='op'>=</span> <span class='fl'>825</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>The API call was successful, you have returned  22 records.</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># get all sites in Wisconsin</span>
<span class='va'>AR_sites</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://docs.ropensci.org/neotoma/reference/get_site.html'>get_site</a></span><span class='op'>(</span>gpid <span class='op'>=</span> <span class='st'>"Argentina"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>The API call was successful, you have returned  32 records.</code></pre>
</div>
<p><code>data.frame</code> stores vectors of equal length. The nice
thing about a <code>data.frame</code> is that each vector can be of a
different type (character, numeric values, <em>etc</em>.). In RStudio,
you can use the Environment panel in upper right to explore
variables.</p>
<p>We pointed out before that the object returned from
<code>get_site</code> is both a <code>data.frame</code> and a
<code>site</code> object. Because it has a special <code>print</code>
method some of the information from the full object is obscured when
printed. You can see all the data in the <code>data.frame</code> using
<code>str</code> (short for <em>structure</em>):</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span><span class='op'>(</span><span class='va'>maule_site</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Let’s look at the <code>description</code> field:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>CH_sites</span><span class='op'>$</span><span class='va'>description</span>

<span class='va'>AR_sites</span><span class='op'>$</span><span class='va'>description</span>
</code></pre>
</div>
</div>
<h3 id="getting-datasets">Getting Datasets</h3>
<p>The structure of the Neotoma data model, as expressed through the
API, is roughly: “<code>counts</code> within <code>download</code>,
<code>download</code> within <code>dataset</code>, <code>dataset</code>
within <code>site</code>”. So a <code>dataset</code> contains more
information than a <code>site</code>, about a particular dataset from
that site.</p>
<p>A site may have a single associated dataset, or multiple. The Neotoma
function <code>get_dataset</code> returns a list of datasets containing
the <strong>metadata</strong> for each <strong>dataset</strong>. We can
pass output from <code>get_site</code> (site metadata) to
<code>get_dataset</code>, even if <code>get_site</code> returns multiple
sites. For example:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>all_chill</span> <span class='op'>&lt;-</span> <span class='fu'>neotoma</span><span class='fu'>::</span><span class='fu'><a href='https://docs.ropensci.org/neotoma/reference/get_dataset.html'>get_dataset</a></span><span class='op'>(</span>gpid <span class='op'>=</span> <span class='fl'>825</span><span class='op'>)</span>

<span class='co'>#Examine the results</span>

<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>all_chill</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>A dataset_list containing 114 objects:
Accessed from 2022-07-14 23:01h to 2022-07-14 23:01h. 
Datasets:
 dataset.id                         site.name      long       lat
         13 Aguas Calientes                   -67.40000 -23.08333
         14 Aguas Calientes 2                 -67.58333 -23.50000
         17 Ajata                             -69.20000 -18.25000
        350 Caunahue                          -72.00000 -40.00000
        362 Chepu                             -73.96667 -42.00000
        488 Isla Clarence                     -71.23333 -54.20000
        536 Cueva Milodon                     -72.63333 -51.58333
       1575 La Esperanza                      -72.83333 -46.63333
       1624 Lejía                             -67.68333 -23.48333
       1880 Puerto Eden                       -74.41667 -49.13333
       1958 Canal de la Puntilla              -72.90500 -40.95250
       2339 San Pedro                         -73.95000 -42.25000
       2635 Tempano Sur                       -74.03333 -48.73333
       2665 Tumbre 1                          -67.78333 -23.31667
       2666 Tumbre 2                          -67.78333 -23.31667
       2674 Tuyajto                           -67.78333 -23.95000
       3556 Canal de la Puntilla              -72.90500 -40.95250
       3557 Canal de la Puntilla              -72.90500 -40.95250
       7862 Aguas Calientes 2                 -67.58333 -23.50000
       7865 Ajata                             -69.20000 -18.25000
       7984 Caunahue                          -72.00000 -40.00000
       8004 Isla Clarence                     -71.23333 -54.20000
       8039 Cueva Milodon                     -72.63333 -51.58333
       8289 La Esperanza                      -72.83333 -46.63333
       8486 Puerto Eden                       -74.41667 -49.13333
       8507 Canal de la Puntilla              -72.90500 -40.95250
       8679 Tempano Sur                       -74.03333 -48.73333
       8699 Tumbre 1                          -67.78333 -23.31667
       8700 Tumbre 2                          -67.78333 -23.31667
       8706 Tuyajto                           -67.78333 -23.95000
       8836 Canal de la Puntilla              -72.90500 -40.95250
      14292 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14293 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14294 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14295 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14300 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14301 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14302 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14303 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14304 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14305 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14306 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14307 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14311 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14312 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14313 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14314 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14315 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14316 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14317 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14318 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14319 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14320 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14321 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14322 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14323 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14324 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14325 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14326 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14327 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14328 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14329 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14330 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14331 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14332 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14333 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14334 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14335 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14336 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14337 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14338 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14339 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14340 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14341 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14342 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14343 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14344 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14345 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14346 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14347 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14348 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14349 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14350 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14351 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14352 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14353 Quebrada La Higuera Upper Middens -69.54445 -18.66160
      14354 Quebrada La Higuera Lower Middens -69.62372 -18.68048
      14355 Quebrada La Higuera Lower Middens -69.62372 -18.68048
      14356 Quebrada La Higuera Lower Middens -69.62372 -18.68048
      14357 Quebrada La Higuera Lower Middens -69.62372 -18.68048
      14358 Quebrada La Higuera Lower Middens -69.62372 -18.68048
      14359 Quebrada La Higuera Lower Middens -69.62372 -18.68048
      14360 Quebrada La Higuera Lower Middens -69.62372 -18.68048
      14361 Quebrada La Higuera Lower Middens -69.62372 -18.68048
      14362 Quebrada La Higuera Lower Middens -69.62372 -18.68048
      14363 Quebrada La Higuera Lower Middens -69.62372 -18.68048
      14364 Quebrada La Higuera Lower Middens -69.62372 -18.68048
      14365 Quebrada La Higuera Lower Middens -69.62372 -18.68048
      14366 Quebrada La Higuera Lower Middens -69.62372 -18.68048
      14367 Quebrada La Higuera Lower Middens -69.62372 -18.68048
      14368 Quebrada La Higuera Lower Middens -69.62372 -18.68048
      15303 Rio Rubens Bog                    -71.87614 -52.03714
      15304 Rio Rubens Bog                    -71.87614 -52.03714
      15305 Rio Rubens Bog                    -71.87614 -52.03714
      15306 Rio Rubens Bog                    -71.87614 -52.03714
      15329 Mallin Pollux                     -71.83794 -45.68859
      15330 Mallin Pollux                     -71.83794 -45.68859
      15331 Mallin Pollux                     -71.83794 -45.68859
      19815 Laguna del Maule                  -70.50141 -36.05363
      19816 Laguna del Maule                  -70.50141 -36.05363
      19817 Laguna del Maule                  -70.50141 -36.05363
      19818 Laguna del Maule                  -70.50141 -36.05363
      48620 Mallin Casanova                   -72.97522 -47.64356
      48621 Mallin Casanova                   -72.97522 -47.64356
              type
 pollen           
 pollen           
 pollen           
 pollen           
 pollen           
 pollen           
 pollen           
 pollen           
 pollen           
 pollen           
 pollen           
 pollen           
 pollen           
 pollen           
 pollen           
 pollen           
 loss-on-ignition 
 pollen           
 geochronologic   
 geochronologic   
 geochronologic   
 geochronologic   
 geochronologic   
 geochronologic   
 geochronologic   
 geochronologic   
 geochronologic   
 geochronologic   
 geochronologic   
 geochronologic   
 geochronologic   
 geochronologic   
 vertebrate fauna 
 plant macrofossil
 pollen           
 geochronologic   
 vertebrate fauna 
 plant macrofossil
 pollen           
 geochronologic   
 vertebrate fauna 
 plant macrofossil
 pollen           
 geochronologic   
 vertebrate fauna 
 plant macrofossil
 pollen           
 geochronologic   
 vertebrate fauna 
 plant macrofossil
 pollen           
 geochronologic   
 vertebrate fauna 
 plant macrofossil
 pollen           
 geochronologic   
 vertebrate fauna 
 plant macrofossil
 pollen           
 geochronologic   
 vertebrate fauna 
 plant macrofossil
 pollen           
 geochronologic   
 vertebrate fauna 
 plant macrofossil
 pollen           
 geochronologic   
 vertebrate fauna 
 plant macrofossil
 pollen           
 geochronologic   
 vertebrate fauna 
 plant macrofossil
 pollen           
 geochronologic   
 vertebrate fauna 
 plant macrofossil
 geochronologic   
 vertebrate fauna 
 plant macrofossil
 pollen           
 geochronologic   
 vertebrate fauna 
 plant macrofossil
 pollen           
 geochronologic   
 vertebrate fauna 
 plant macrofossil
 pollen           
 geochronologic   
 vertebrate fauna 
 plant macrofossil
 pollen           
 geochronologic   
 vertebrate fauna 
 plant macrofossil
 pollen           
 geochronologic   
 vertebrate fauna 
 plant macrofossil
 geochronologic   
 plant macrofossil
 charcoal         
 pollen           
 geochronologic   
 charcoal         
 pollen           
 geochronologic   
 testate amoebae  
 pollen           
 diatom           
 geochronologic   
 pollen           </code></pre>
<pre><code>NULL</code></pre>
</div>
<p>Use get.tables(‘GeoPoliticalUnits’) for a list of acceptable values,
or link here: <a href="http://api.neotomadb.org/apdx/geopol.htm"
class="uri">http://api.neotomadb.org/apdx/geopol.htm</a></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>all_chill</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="neotoma_files/figure-html5/plotch-1.png" width="624" /></p>
</div>
<p>Make sure the leaflet package is installed using
install.packages(‘leaflet’), and then let’s check out what we get:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://rstudio.github.io/leaflet/'>leaflet</a></span><span class='op'>)</span>

<span class='co'># We're going to use this multiple times I think, so let's make it a function:</span>

<span class='va'>leaflet_map</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>dataset_in</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>dataset_summary</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/do.call.html'>do.call</a></span><span class='op'>(</span><span class='va'>rbind</span>, <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>dataset_in</span>, 
                        <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>{</span>
                          <span class='co'># here we pull out the site information from the `dataset` objects:</span>
                          <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>name <span class='op'>=</span> <span class='va'>x</span><span class='op'>$</span><span class='va'>site.data</span><span class='op'>$</span><span class='va'>site.name</span>,
                                     lat  <span class='op'>=</span> <span class='va'>x</span><span class='op'>$</span><span class='va'>site.data</span><span class='op'>$</span><span class='va'>lat</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='op'>-</span><span class='fl'>0.005</span>, <span class='fl'>0.005</span><span class='op'>)</span>,
                                     long <span class='op'>=</span> <span class='va'>x</span><span class='op'>$</span><span class='va'>site.data</span><span class='op'>$</span><span class='va'>long</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='op'>-</span><span class='fl'>0.005</span>, <span class='fl'>0.005</span><span class='op'>)</span>,
                                     type <span class='op'>=</span> <span class='va'>x</span><span class='op'>$</span><span class='va'>dataset.meta</span><span class='op'>$</span><span class='va'>dataset.type</span><span class='op'>)</span>
                        <span class='op'>}</span><span class='op'>)</span><span class='op'>)</span>
  
  <span class='co'># The leaflet package documentation uses piping.  For the sake of this tutorial, I won't.</span>
  <span class='co'># First, define a color palette for the dataset type symbol plotting.</span>
  <span class='va'>pal</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/leaflet/man/colorNumeric.html'>colorFactor</a></span><span class='op'>(</span><span class='st'>"Dark2"</span>, domain <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/levels.html'>levels</a></span><span class='op'>(</span><span class='va'>dataset_summary</span><span class='op'>$</span><span class='va'>type</span><span class='op'>)</span><span class='op'>)</span>
  
  <span class='co'># Now make the leaflet map, add base raster tiles and then add the markers for the records:</span>
  <span class='va'>map</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/leaflet/man/leaflet.html'>leaflet</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>dataset_summary</span><span class='op'>)</span>
  <span class='va'>map</span> <span class='op'>&lt;-</span> <span class='fu'>leaflet</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/leaflet/man/map-layers.html'>addTiles</a></span><span class='op'>(</span><span class='va'>map</span><span class='op'>)</span>
  <span class='va'>map</span> <span class='op'>&lt;-</span> <span class='fu'>leaflet</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/leaflet/man/map-layers.html'>addCircleMarkers</a></span><span class='op'>(</span><span class='va'>map</span>, <span class='op'>~</span><span class='va'>long</span>, <span class='op'>~</span><span class='va'>lat</span>, 
                                   popup <span class='op'>=</span> <span class='op'>~</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"Site: "</span>, <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>name</span><span class='op'>)</span>, <span class='st'>"&lt;br&gt;"</span>,
                                                   <span class='st'>"Type: "</span>, 
                                                   <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>dataset_summary</span><span class='op'>$</span><span class='va'>type</span><span class='op'>)</span><span class='op'>)</span>,
                                   color <span class='op'>=</span> <span class='op'>~</span><span class='fu'>pal</span><span class='op'>(</span><span class='va'>type</span><span class='op'>)</span>,
                                   stroke <span class='op'>=</span> <span class='cn'>FALSE</span>, fillOpacity <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>
  <span class='co'># You need to explicitly call the `map` object to make it appear!</span>
  <span class='va'>map</span>
<span class='op'>}</span>

<span class='co'># Since that's all wrapped in a function, we can all it with any `dataset_list`:</span>
<span class='fu'>leaflet_map</span><span class='op'>(</span><span class='va'>all_chill</span><span class='op'>)</span>
</code></pre>
</div>
<div id="htmlwidget-820f3e47ccabc591b824" style="width:624px;height:384px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-820f3e47ccabc591b824">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addCircleMarkers","args":[[-23.0789077522251,-23.4978768847976,-18.2478724708478,-39.9974576117587,-42.0036214151629,-54.2019744577282,-51.5846289281425,-46.6288844332745,-23.4880742888426,-49.130373443935,-40.9569198497059,-42.2546113535808,-48.7312716347183,-23.3185518563987,-23.3168453191087,-23.9467646326032,-40.9571832299582,-40.9533987401961,-23.4974702269724,-18.2503677860554,-40.0028680671053,-54.1971065058676,-51.58772897246,-46.6370703772566,-49.1343278978992,-40.9499146803864,-48.7319601305708,-23.3193771743128,-23.3133209498442,-23.9520521716611,-40.9567006723909,-18.6600138939087,-18.6592571332244,-18.6622369077368,-18.662660161395,-18.6626360179353,-18.6665249916151,-18.6601402167309,-18.6576533603397,-18.6610660957251,-18.6647814023433,-18.6643764271433,-18.6645033762752,-18.6590228600459,-18.666234646005,-18.6639068253091,-18.6614277928098,-18.6572848863326,-18.6601509818932,-18.6662592308232,-18.6604924783911,-18.660113988622,-18.6613008701484,-18.6603175874133,-18.6572916793599,-18.6626842421558,-18.665861461969,-18.6654769788574,-18.6617454662741,-18.6614600228596,-18.6591023167394,-18.6594561636899,-18.6585726066221,-18.6613070263699,-18.6597976663717,-18.6616555547327,-18.6619651298233,-18.6638273260006,-18.6596015452532,-18.6645608840751,-18.6573365906541,-18.6642148449653,-18.6608446072446,-18.6582497910512,-18.6583636721628,-18.6590099306599,-18.6625666492254,-18.6593476714831,-18.6661965806209,-18.6582487489291,-18.6656249674954,-18.6654335523964,-18.6645879116174,-18.6640819184421,-18.6637155726048,-18.6597593417726,-18.6824845677348,-18.6810772995058,-18.681491015159,-18.6818880899333,-18.683477792343,-18.6763540323976,-18.6806207605022,-18.6843750628353,-18.682958465001,-18.6836477743265,-18.6839408527863,-18.6765819058836,-18.6790449546966,-18.6766553500168,-18.6773982941163,-52.032507950357,-52.040886507063,-52.0336629039756,-52.041980797158,-45.6847527786304,-45.684357844962,-45.6875071254542,-36.0524840818115,-36.0546156862427,-36.0495845819407,-36.0581803755232,-47.6441039710943,-47.6391950928545],[-67.4016879278515,-67.5826469852653,-69.2041739534074,-71.9999288380053,-73.9685954436852,-71.2382314876857,-72.6337929229735,-72.8380602112733,-67.6866438117827,-74.4196567647863,-72.9037942796177,-73.9510177464597,-74.0359544220654,-67.7799029984669,-67.7796455445181,-67.7844661467307,-72.9073979398119,-72.9006157475663,-67.5825482716918,-69.2041817923542,-71.9981483366829,-71.2316531079117,-72.6299732866435,-72.8369414814742,-74.4199005449173,-72.9036027715728,-74.0355884020723,-67.7800951642817,-67.7835694806342,-67.7877564967278,-72.9022357564513,-69.5396263212308,-69.5485709384496,-69.5422250197496,-69.5405867428745,-69.5467976409703,-69.5462834858702,-69.5425721900322,-69.545510270241,-69.5401656146714,-69.5462152320536,-69.5476027074077,-69.5418679813592,-69.543851385223,-69.5394793215341,-69.5440196016774,-69.5483982455468,-69.5470059740304,-69.5442099597275,-69.5421671279257,-69.5394553019682,-69.5427261230855,-69.5483875945716,-69.5437456644227,-69.5443611433583,-69.5453541575994,-69.5427644860971,-69.5468698033311,-69.5413084568822,-69.5433162827877,-69.5460895037156,-69.548550716915,-69.5453381106391,-69.5451041574211,-69.5423052110703,-69.5404052890528,-69.5494365473528,-69.541992309002,-69.5411235345777,-69.5406756677705,-69.5462441669678,-69.5397624040295,-69.5439975453185,-69.5464795149507,-69.5406436767516,-69.5410466953873,-69.5434158573969,-69.548868674456,-69.5432967356237,-69.5420561124425,-69.5462811096751,-69.5469996783108,-69.5466774028696,-69.5485197548259,-69.5446323463827,-69.5402952813025,-69.6189937271189,-69.6277530402096,-69.6271581712702,-69.6223135426721,-69.6257997580955,-69.619022930361,-69.624565991942,-69.6199617734423,-69.6283992099819,-69.6285156928386,-69.6232843381503,-69.6245303397753,-69.6263573226972,-69.6218638046143,-69.62678814971,-71.8802602218435,-71.8732832676446,-71.8724184244493,-71.8763201230805,-71.8419099828616,-71.8382914556346,-71.835855695686,-70.5007557452743,-70.505523437098,-70.5047699943761,-70.5015817611775,-72.9750605190363,-72.9770284647638],10,null,null,{"interactive":true,"className":"","stroke":false,"color":["#E6AB02","#E6AB02","#E6AB02","#E6AB02","#E6AB02","#E6AB02","#E6AB02","#E6AB02","#E6AB02","#E6AB02","#E6AB02","#E6AB02","#E6AB02","#E6AB02","#E6AB02","#E6AB02","#E7298A","#E6AB02","#7570B3","#7570B3","#7570B3","#7570B3","#7570B3","#7570B3","#7570B3","#7570B3","#7570B3","#7570B3","#7570B3","#7570B3","#7570B3","#7570B3","#666666","#66A61E","#E6AB02","#7570B3","#666666","#66A61E","#E6AB02","#7570B3","#666666","#66A61E","#E6AB02","#7570B3","#666666","#66A61E","#E6AB02","#7570B3","#666666","#66A61E","#E6AB02","#7570B3","#666666","#66A61E","#E6AB02","#7570B3","#666666","#66A61E","#E6AB02","#7570B3","#666666","#66A61E","#E6AB02","#7570B3","#666666","#66A61E","#E6AB02","#7570B3","#666666","#66A61E","#E6AB02","#7570B3","#666666","#66A61E","#E6AB02","#7570B3","#666666","#66A61E","#7570B3","#666666","#66A61E","#E6AB02","#7570B3","#666666","#66A61E","#E6AB02","#7570B3","#666666","#66A61E","#E6AB02","#7570B3","#666666","#66A61E","#E6AB02","#7570B3","#666666","#66A61E","#E6AB02","#7570B3","#666666","#66A61E","#7570B3","#66A61E","#1B9E77","#E6AB02","#7570B3","#1B9E77","#E6AB02","#7570B3","#A6761D","#E6AB02","#D95F02","#7570B3","#E6AB02"],"weight":5,"opacity":0.5,"fill":true,"fillColor":["#E6AB02","#E6AB02","#E6AB02","#E6AB02","#E6AB02","#E6AB02","#E6AB02","#E6AB02","#E6AB02","#E6AB02","#E6AB02","#E6AB02","#E6AB02","#E6AB02","#E6AB02","#E6AB02","#E7298A","#E6AB02","#7570B3","#7570B3","#7570B3","#7570B3","#7570B3","#7570B3","#7570B3","#7570B3","#7570B3","#7570B3","#7570B3","#7570B3","#7570B3","#7570B3","#666666","#66A61E","#E6AB02","#7570B3","#666666","#66A61E","#E6AB02","#7570B3","#666666","#66A61E","#E6AB02","#7570B3","#666666","#66A61E","#E6AB02","#7570B3","#666666","#66A61E","#E6AB02","#7570B3","#666666","#66A61E","#E6AB02","#7570B3","#666666","#66A61E","#E6AB02","#7570B3","#666666","#66A61E","#E6AB02","#7570B3","#666666","#66A61E","#E6AB02","#7570B3","#666666","#66A61E","#E6AB02","#7570B3","#666666","#66A61E","#E6AB02","#7570B3","#666666","#66A61E","#7570B3","#666666","#66A61E","#E6AB02","#7570B3","#666666","#66A61E","#E6AB02","#7570B3","#666666","#66A61E","#E6AB02","#7570B3","#666666","#66A61E","#E6AB02","#7570B3","#666666","#66A61E","#E6AB02","#7570B3","#666666","#66A61E","#7570B3","#66A61E","#1B9E77","#E6AB02","#7570B3","#1B9E77","#E6AB02","#7570B3","#A6761D","#E6AB02","#D95F02","#7570B3","#E6AB02"],"fillOpacity":0.5},null,null,["Site: Aguas Calientes<br>Type: pollen","Site: Aguas Calientes 2<br>Type: pollen","Site: Ajata<br>Type: pollen","Site: Caunahue<br>Type: pollen","Site: Chepu<br>Type: pollen","Site: Isla Clarence<br>Type: pollen","Site: Cueva Milodon<br>Type: pollen","Site: La Esperanza<br>Type: pollen","Site: Lejía<br>Type: pollen","Site: Puerto Eden<br>Type: pollen","Site: Canal de la Puntilla<br>Type: pollen","Site: San Pedro<br>Type: pollen","Site: Tempano Sur<br>Type: pollen","Site: Tumbre 1<br>Type: pollen","Site: Tumbre 2<br>Type: pollen","Site: Tuyajto<br>Type: pollen","Site: Canal de la Puntilla<br>Type: loss-on-ignition","Site: Canal de la Puntilla<br>Type: pollen","Site: Aguas Calientes 2<br>Type: geochronologic","Site: Ajata<br>Type: geochronologic","Site: Caunahue<br>Type: geochronologic","Site: Isla Clarence<br>Type: geochronologic","Site: Cueva Milodon<br>Type: geochronologic","Site: La Esperanza<br>Type: geochronologic","Site: Puerto Eden<br>Type: geochronologic","Site: Canal de la Puntilla<br>Type: geochronologic","Site: Tempano Sur<br>Type: geochronologic","Site: Tumbre 1<br>Type: geochronologic","Site: Tumbre 2<br>Type: geochronologic","Site: Tuyajto<br>Type: geochronologic","Site: Canal de la Puntilla<br>Type: geochronologic","Site: Quebrada La Higuera Upper Middens<br>Type: geochronologic","Site: Quebrada La Higuera Upper Middens<br>Type: vertebrate fauna","Site: Quebrada La Higuera Upper Middens<br>Type: plant macrofossil","Site: Quebrada La Higuera Upper Middens<br>Type: pollen","Site: Quebrada La Higuera Upper Middens<br>Type: geochronologic","Site: Quebrada La Higuera Upper Middens<br>Type: vertebrate fauna","Site: Quebrada La Higuera Upper Middens<br>Type: plant macrofossil","Site: Quebrada La Higuera Upper Middens<br>Type: pollen","Site: Quebrada La Higuera Upper Middens<br>Type: geochronologic","Site: Quebrada La Higuera Upper Middens<br>Type: vertebrate fauna","Site: Quebrada La Higuera Upper Middens<br>Type: plant macrofossil","Site: Quebrada La Higuera Upper Middens<br>Type: pollen","Site: Quebrada La Higuera Upper Middens<br>Type: geochronologic","Site: Quebrada La Higuera Upper Middens<br>Type: vertebrate fauna","Site: Quebrada La Higuera Upper Middens<br>Type: plant macrofossil","Site: Quebrada La Higuera Upper Middens<br>Type: pollen","Site: Quebrada La Higuera Upper Middens<br>Type: geochronologic","Site: Quebrada La Higuera Upper Middens<br>Type: vertebrate fauna","Site: Quebrada La Higuera Upper Middens<br>Type: plant macrofossil","Site: Quebrada La Higuera Upper Middens<br>Type: pollen","Site: Quebrada La Higuera Upper Middens<br>Type: geochronologic","Site: Quebrada La Higuera Upper Middens<br>Type: vertebrate fauna","Site: Quebrada La Higuera Upper Middens<br>Type: plant macrofossil","Site: Quebrada La Higuera Upper Middens<br>Type: pollen","Site: Quebrada La Higuera Upper Middens<br>Type: geochronologic","Site: Quebrada La Higuera Upper Middens<br>Type: vertebrate fauna","Site: Quebrada La Higuera Upper Middens<br>Type: plant macrofossil","Site: Quebrada La Higuera Upper Middens<br>Type: pollen","Site: Quebrada La Higuera Upper Middens<br>Type: geochronologic","Site: Quebrada La Higuera Upper Middens<br>Type: vertebrate fauna","Site: Quebrada La Higuera Upper Middens<br>Type: plant macrofossil","Site: Quebrada La Higuera Upper Middens<br>Type: pollen","Site: Quebrada La Higuera Upper Middens<br>Type: geochronologic","Site: Quebrada La Higuera Upper Middens<br>Type: vertebrate fauna","Site: Quebrada La Higuera Upper Middens<br>Type: plant macrofossil","Site: Quebrada La Higuera Upper Middens<br>Type: pollen","Site: Quebrada La Higuera Upper Middens<br>Type: geochronologic","Site: Quebrada La Higuera Upper Middens<br>Type: vertebrate fauna","Site: Quebrada La Higuera Upper Middens<br>Type: plant macrofossil","Site: Quebrada La Higuera Upper Middens<br>Type: pollen","Site: Quebrada La Higuera Upper Middens<br>Type: geochronologic","Site: Quebrada La Higuera Upper Middens<br>Type: vertebrate fauna","Site: Quebrada La Higuera Upper Middens<br>Type: plant macrofossil","Site: Quebrada La Higuera Upper Middens<br>Type: pollen","Site: Quebrada La Higuera Upper Middens<br>Type: geochronologic","Site: Quebrada La Higuera Upper Middens<br>Type: vertebrate fauna","Site: Quebrada La Higuera Upper Middens<br>Type: plant macrofossil","Site: Quebrada La Higuera Upper Middens<br>Type: geochronologic","Site: Quebrada La Higuera Upper Middens<br>Type: vertebrate fauna","Site: Quebrada La Higuera Upper Middens<br>Type: plant macrofossil","Site: Quebrada La Higuera Upper Middens<br>Type: pollen","Site: Quebrada La Higuera Upper Middens<br>Type: geochronologic","Site: Quebrada La Higuera Upper Middens<br>Type: vertebrate fauna","Site: Quebrada La Higuera Upper Middens<br>Type: plant macrofossil","Site: Quebrada La Higuera Upper Middens<br>Type: pollen","Site: Quebrada La Higuera Lower Middens<br>Type: geochronologic","Site: Quebrada La Higuera Lower Middens<br>Type: vertebrate fauna","Site: Quebrada La Higuera Lower Middens<br>Type: plant macrofossil","Site: Quebrada La Higuera Lower Middens<br>Type: pollen","Site: Quebrada La Higuera Lower Middens<br>Type: geochronologic","Site: Quebrada La Higuera Lower Middens<br>Type: vertebrate fauna","Site: Quebrada La Higuera Lower Middens<br>Type: plant macrofossil","Site: Quebrada La Higuera Lower Middens<br>Type: pollen","Site: Quebrada La Higuera Lower Middens<br>Type: geochronologic","Site: Quebrada La Higuera Lower Middens<br>Type: vertebrate fauna","Site: Quebrada La Higuera Lower Middens<br>Type: plant macrofossil","Site: Quebrada La Higuera Lower Middens<br>Type: pollen","Site: Quebrada La Higuera Lower Middens<br>Type: geochronologic","Site: Quebrada La Higuera Lower Middens<br>Type: vertebrate fauna","Site: Quebrada La Higuera Lower Middens<br>Type: plant macrofossil","Site: Rio Rubens Bog<br>Type: geochronologic","Site: Rio Rubens Bog<br>Type: plant macrofossil","Site: Rio Rubens Bog<br>Type: charcoal","Site: Rio Rubens Bog<br>Type: pollen","Site: Mallin Pollux<br>Type: geochronologic","Site: Mallin Pollux<br>Type: charcoal","Site: Mallin Pollux<br>Type: pollen","Site: Laguna del Maule<br>Type: geochronologic","Site: Laguna del Maule<br>Type: testate amoebae","Site: Laguna del Maule<br>Type: pollen","Site: Laguna del Maule<br>Type: diatom","Site: Mallin Casanova<br>Type: geochronologic","Site: Mallin Casanova<br>Type: pollen"],null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[-54.2019744577282,-18.2478724708478],"lng":[-74.4199005449173,-67.4016879278515]}},"evals":[],"jsHooks":[]}</script>
</div>
<h3 id="get_download">Get_Download</h3>
<p>The Neotoma function <code>get_download()</code> returns a
<code>list</code> that stores a list of <code>download</code> objects -
one for each retrieved <code>dataset</code>. Note that
<code>get_download()</code> returns the actual (raw) data associated
with each dataset, rather than a list of the available datasets, as in
<code>get_dataset()</code> above. Each download object contains a suite
of data for the samples in that dataset.</p>
<p>Using the <code>get_download()</code> will accept an object of class
<code>dataset</code> (ie, <code>tas_dataset</code>), but also of class
<code>site</code> (ie, <code>lagoon_sites</code>), since it will
automatically query for the datasets associated in each site.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>CH_all</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://docs.ropensci.org/neotoma/reference/get_download.html'>get_download</a></span><span class='op'>(</span><span class='va'>CH_sites</span><span class='op'>)</span>
<span class='co'>#print(CH_all)</span>
</code></pre>
</div>
</div>
<p>There are a number of messages that appear. These can be suppressed
with the flag <code>verbose = FALSE</code> in the function call. One
thing you’ll note is that not all of the datasets can be downloaded
directly to a <code>download</code> objct. This is because
<code>geochronologic</code> datasets have a different data structure
than other data, requiring different fields, and as such, they can be
obtained using the <code>get_geochron()</code> function.</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<p>The result is effectively the inverse of the first.</p>
<p>Get the datasets for just El Maule (dataset 19817):</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>maule_pd</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://docs.ropensci.org/neotoma/reference/get_download.html'>get_download</a></span><span class='op'>(</span><span class='fl'>19817</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Let’s examine the available data in this download</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span><span class='op'>(</span><span class='va'>maule_pd</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>There are 6 associated fields:</p>
<ol type="1">
<li><p>dataset</p>
<ul>
<li>site.data</li>
<li>dataset.meta</li>
<li>pi.data</li>
<li>submission</li>
<li>access.date</li>
<li>site</li>
</ul></li>
<li><p>sample.meta</p></li>
<li><p>taxon.list</p></li>
<li><p>counts</p></li>
<li><p>lab.data</p></li>
<li><p>chronologies</p></li>
</ol>
<p>Within the download object, <code>sample.meta</code> stores the core
depth and age information for that dataset. We just want to look at the
first few lines, so are using the <code>head()</code> function. Let’s
explore different facets of the dataset</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>maule_pd</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>$</span><span class='va'>sample.meta</span><span class='op'>)</span>
<span class='co'>#taxon.list stores a list of taxa found in the dataset</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>maule_pd</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>$</span><span class='va'>taxon.list</span><span class='op'>)</span>
<span class='co'>#counts stores the the counts, presence/absence data, or percentage data for each taxon for each sample</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>maule_pd</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>$</span><span class='va'>counts</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Here we can get to the papers that published about a site of
interest:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://docs.ropensci.org/neotoma/reference/get_publication.html'>get_publication</a></span><span class='op'>(</span>datasetid <span class='op'>=</span> <span class='fl'>19817</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h1 id="multi-site-analysis">Multi-Site Analysis</h1>
<div class="sourceCode" id="cb9"><pre
class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
<h3 id="reuse">Reuse</h3>
<p>Text and figures are licensed under Creative Commons Attribution <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a>. The figures that have been reused from other sources don't fall under this license and can be recognized by a note in their caption: "Figure from ...".</p>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
